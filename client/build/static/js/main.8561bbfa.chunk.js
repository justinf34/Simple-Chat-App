(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{106:function(e,t,n){"use strict";n.r(t);var s=n(5),o=n(0),i=n.n(o),a=n(19),r=n.n(a),c=(n(68),n(42)),l=n.n(c),h=n(58),u=n(15),d=n(16),g=n(6),m=n(18),f=n(17),v=(n(70),n(71),n(59)),p=n.n(v),j=n(108),b=n(109),O=n(110),k=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(e){var s;return Object(u.a)(this,n),(s=t.call(this,e)).state={messages:[],msg:"",show:!1,alert:""},s.handleClose=s.handleClose.bind(Object(g.a)(s)),s.handleOpen=s.handleOpen.bind(Object(g.a)(s)),s.handleChange=s.handleChange.bind(Object(g.a)(s)),s.handleSubmit=s.handleSubmit.bind(Object(g.a)(s)),s.onNewMsgList=s.onNewMsgList.bind(Object(g.a)(s)),s.onDeniedNameChange=s.onDeniedNameChange.bind(Object(g.a)(s)),s}return Object(d.a)(n,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleOpen",value:function(){var e=this;this.setState({show:!0},(function(){window.setTimeout((function(){e.setState({show:!1})}),2e3)}))}},{key:"handleChange",value:function(e){this.setState({msg:e.target.value})}},{key:"handleSubmit",value:function(e){if(e.preventDefault(),this.state.msg){var t=this.state.msg;if(t.startsWith("/color"))this.colorChange(t);else if(t.startsWith("/name"))this.nameChange(t);else{t=t.replaceAll(":)","\ud83d\ude01").replaceAll(":(","\ud83d\ude41").replaceAll(":o","\ud83d\ude32"),console.log("Sending message: ",t);var n={id:this.props.id,type:1,message:t};this.props.socket.sendMessage(n),this.setState({msg:""})}}}},{key:"onNewMsgList",value:function(e){this.setState({messages:e})}},{key:"setAlert",value:function(e){var t=this;this.setState({show:!0,alert:e,msg:""},(function(){window.setTimeout((function(){t.setState({show:!1})}),2e3)}))}},{key:"nameChange",value:function(e){var t=e.split(" ");2!=t.length?(console.log("Wrong use of /name! Need the right amount of args!"),this.setAlert("Wrong use of /name! Need the right amount of args!")):/\s/g.test(t[1])?(console.log("Name must not contain spaces"),this.setAlert("Name must not contain spaces")):(console.log("Changing name...."),this.props.socket.changeName(t[1]),this.setState({msg:""}))}},{key:"colorChange",value:function(e){var t=e.split(" ");if(2!=t.length)console.log("Wrong use of /color! Need the right amount of args!"),this.setAlert("Wrong use of /color! Need the right amount of args!");else{/^#([0-9A-F]{6}){1,2}$/i.test("#"+t[1])?(console.log("Changing color...."),this.props.socket.changeColor(t[1]),this.setState({msg:""})):(console.log("Wrong use of /color! Invalid color!"),console.log("Wrong use of /color! Invalid color!"),this.setAlert("Wrong use of /color! Invalid color!"))}}},{key:"renderMsgs",value:function(){var e=this,t=[];return this.state.messages.forEach((function(n,o){t.push(Object(s.jsx)("div",{className:"chat-message",style:{color:"#"+n.color,fontWeight:n.id===e.props.id?"bold":"normal"},children:n.date+" "+(0===n.type?n.id===e.props.id?"You ":n.author+" ":n.author+": ")+n.message},o))})),t}},{key:"onDeniedNameChange",value:function(){console.log("Username taken"),this.setAlert("Username taken!")}},{key:"scrollToChatBottom",value:function(){this.panel.scrollTo(0,this.panel.scrollHeight)}},{key:"componentDidMount",value:function(){var e=this.props.socket;e.registerNewMsgList(this.onNewMsgList),e.registerDeniedNameChange(this.onDeniedNameChange)}},{key:"componentDidUpdate",value:function(){this.scrollToChatBottom()}},{key:"render",value:function(){var e=this;return console.log("Message",this.state.messages),Object(s.jsxs)("div",{className:"chat-container",children:[Object(s.jsx)(b.a,{show:this.state.show,variant:"danger",dismissible:!0,onClose:this.handleClose,style:{margin:"auto",position:"absolute",top:"0%",left:"50%",transform:"translate(-50%, 0%)"},children:this.state.alert}),Object(s.jsx)("div",{className:"chat-log",ref:function(t){e.panel=t},children:this.renderMsgs()}),Object(s.jsxs)(O.a,{className:"chat-input-area",onSubmit:this.handleSubmit,children:[Object(s.jsx)(O.a.Control,{type:"text",placeholder:"Type a message..",value:this.state.msg,onChange:this.handleChange}),Object(s.jsx)(j.a,{type:"submit",children:"Send"})]})]})}}]),n}(o.Component),y=n(62),N=n(111),C=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(e){var s;return Object(u.a)(this,n),(s=t.call(this,e)).state={user_list:[]},s.onUsersList=s.onUsersList.bind(Object(g.a)(s)),s.onNewUser=s.onNewUser.bind(Object(g.a)(s)),s.onLeaveUser=s.onLeaveUser.bind(Object(g.a)(s)),s}return Object(d.a)(n,[{key:"generateUserList",value:function(){var e=this,t=[];return this.state.user_list.forEach((function(n,o){var i=Object(s.jsx)(y.a,{className:"border-0",children:Object(s.jsx)("div",{className:"user-li",style:{color:"#"+n.color,fontWeight:n.id===e.props.id?"bold":"normal"},children:n.name+(n.id===e.props.id?"(You)":"")})},o);n.id===e.props.id?t.unshift(i):t.push(i)})),t}},{key:"onUsersList",value:function(e){console.log("onUsersList",e),this.setState({user_list:e})}},{key:"onNewUser",value:function(e){console.log("onNewUser",e),this.setState((function(t,n){return t.push(e),{}}))}},{key:"onLeaveUser",value:function(e){console.log("onLeaveUser"),this.setState((function(t,n){return t.user_list.splice(t.user_list.findIndex((function(t){return t.name===e.name})),1),{}}))}},{key:"componentDidMount",value:function(){var e=this.props.socket;e.registerUsersList(this.onUsersList),e.registerNewUser(this.onUsersList),e.registerLeaveUser(this.onUsersList)}},{key:"render",value:function(){return Object(s.jsxs)("div",{className:"online-user-container",children:[Object(s.jsx)("div",{className:"online-user-header",children:Object(s.jsx)("b",{children:"Online users:"})}),Object(s.jsx)("div",{className:"online-user-list",children:Object(s.jsx)(N.a,{children:this.generateUserList()})})]})}}]),n}(o.Component),w=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(e){var s;return Object(u.a)(this,n),(s=t.call(this,e)).server_socket=function(){var e=p()("");return e.on("connect",(function(e){console.log("Connected to the server socket...")})),e.on("error",(function(e){console.warn("received socket error: ",e)})),{joinRoomID:function(t){e.emit("joinID",t)},registerDisconnect:function(t){e.on("disconnect",t)},registerUsersList:function(t){e.on("usersList",t)},registerNewUser:function(t){e.on("newUser",t)},registerLeaveUser:function(t){e.on("leaveUser",t)},registerNewMsgList:function(t){e.on("newMessageList",t)},sendMessage:function(t){e.emit("message",t)},changeColor:function(t){e.emit("color-change",t)},changeName:function(t){e.emit("name-change",t)},registerDeniedNameChange:function(t){e.on("name-change-denied",t)}}}(),s.state={connected:!1,id:null},s.onRetry=s.onRetry.bind(Object(g.a)(s)),s.onDisconnect=s.onDisconnect.bind(Object(g.a)(s)),s}return Object(d.a)(n,[{key:"getUserID",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/id",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include",method:"POST"});case 3:return t=e.sent,e.next=6,t.json();case 6:return e.sent,n=document.cookie.split("; ").find((function(e){return e.startsWith("user_id")})).split("=")[1],console.log("getUserID: ",n),e.abrupt("return",n);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"onRetry",value:function(){var e=this;this.getUserID().then((function(t){e.server_socket.joinRoomID(t),e.setState({id:t,connected:!0})})).catch((function(e){return console.log(e)}))}},{key:"onDisconnect",value:function(){this.setState({connected:!1})}},{key:"componentDidMount",value:function(){var e=this;this.getUserID().then((function(t){e.server_socket.joinRoomID(t),e.server_socket.registerDisconnect(e.onDisconnect),e.setState({id:t,connected:!0})})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){return Object(s.jsx)("div",{className:"App",children:this.state.id?Object(s.jsxs)(i.a.Fragment,{children:[Object(s.jsx)(k,{userName:this.state.username,id:this.state.id,color:this.state.user_color,socket:this.server_socket}),Object(s.jsx)(C,{userName:this.state.username,id:this.state.id,socket:this.server_socket})]}):Object(s.jsxs)("div",{className:"no-connection",children:[Object(s.jsx)("h3",{children:"Cannot connect to the server :^("}),Object(s.jsx)(j.a,{onClick:this.onRetry,children:"Retry"})]})})}}]),n}(o.Component),U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,112)).then((function(t){var n=t.getCLS,s=t.getFID,o=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),s(e),o(e),i(e),a(e)}))};r.a.render(Object(s.jsx)(i.a.StrictMode,{children:Object(s.jsx)(w,{})}),document.getElementById("root")),U()},68:function(e,t,n){},70:function(e,t,n){}},[[106,1,2]]]);
//# sourceMappingURL=main.8561bbfa.chunk.js.map